# 4.1 데이터베이스의 기본

- 데이터 베이스(DB, DataBase)
  - 일정한 규칙, 규약을 통해 구조화되어 저장되는 데이터의 모음
  - DBMS(DataBase Management System) : DB를 제어, 관리하는 통합 시스템
  - DB 안에 있는 데이터들은 쿼리 언어를 통해 삽입, 삭제, 수정, 조회 등을 할 수 있음
  - 실시간 접근, 동시 공유 가능
  - ![DBMS](./images/dbms.png)

## 4.1.1 엔티티

- 엔티티(entity)
  - 사람, 장소, 물건, 사건, 개념 등 여러 개의 속성을 지닌 명사
  - 서비스의 요구 사항에 맞춰 속성 정해짐
  - 약한 엔티티 vs 강한 엔티티
    - A가 B의 존재 여부에 종속적이라면 A는 약한 엔티티, B는 강한 엔티티
    - A: 방, B : 건물

## 4.1.2 릴레이션

- 릴레이션(relation)

  - DB에서 정보를 구분하여 저장하는 기본 단위
  - DB는 엔티티에 관한 데이터를 릴레이션 하나에 담아 관리

- 테이블과 컬렉션
  - MySQL(관계형 DB) 구조 : 레코드-테이블-데이터베이스
  - MongoDM(NoSQL) 구조 : 도큐먼트-컬렉션-데이터베이스

## 4.1.3 속성

- 속성(attribute)
  - 릴레이션에서 관리하는 구체적이며 고유한 이름을 갖는 정보
  - 서비스의 요구사항을 기반으로 관리해야할 필요가 있는 속성들

## 4.1.4 도메인

- 도메인(domain)
  - 릴레이션에 포함된 각각의 속성들이 가질 수 있는 값의 집합
  - 예) 성별(속성) : 여자, 남자(도메인)

## 4.1.5 필드와 레코드

![필드와 레코드](./images/field_record.jpeg)

- 필드 : 학년,소속, 성명...
- 레코드(튜플) : 행 단위 데이터

- 필드 타입
  - ![데이터타입](./images/data_type.jpeg)
  - CHAR : 레코드를 저장할 때 선언한 길이 값으로 고정해서 저장
    - 검색에 유리
  - VARCHAR : 가변 길이 문자열 :point_right: 입력한 데이터에 따라 용량을 가변시켜 저장
    - 검색을 별로 하지 않고 유동적인 길이를 가진 데이터에 유리
  - TEXT
    - 큰 문자열 저장
    - 주로 게시판 본문 저장
  - BLOB
    - 이미지, 동영상 등 큰 데이터 저장
    - 보통 아마존 이미지 호스팅 서버인 S3 같은 서버에 파일을 올리고 파일에 관한 경로를 VARCHAR로 저장
  - ENUM, SET : 공간적으로 이점 but 애플리케이션 수정에 따라 정의한 목록을 수정해야함
    - ENUM
      - 형태 : ENUM('x-small','small','medium','large','x-large) 중 하나만 선택
      - ENUM 리스트에 없는 잘못된 값을 삽입하면 빈 문자열이 입력됨
      - 장점 :x-small 등이 0,1 등으로 매핑되어 메모리를 적게 사용
      - 최대 65535개 요소
    - SET
      - 여러 개의 데이터를 선택할 수 있음
      - 비트 단위의 연산 가능
      - 최대 64개 요소

## 4.1.6 관계

![관계](./images/arrow.jpg)
![관계화살표](./images/arrow2.png)

### 1:1 관계

![1:1](./images/1;1.png)

- 테이블을 두 개의 테이블로 나눠 테이블의 구조를 이해하기 쉽게 만듦

### 1:N 관계

![1:N](./images/1N.png)

- 한 개체가 다른 많은 개체를 포함하는 관계

### N:M 관계

![N:M](./images/NM.png)
![나눔](./images/1n1m.png)

- 테이블 두 개를 직접적으로 연결해서 구축하지 않고 1:N, 1:M 관계를 갖는 테이블 두 개로 나눠서 설정

## 4.1.7 키

![키](./images/keys.png)

- 기본키(Primary Key,PK, 프라이머리 키)
  - 유일성, 최소성
  - 테이블 데이터 중 고유하게 존재하는 속성(중복 불가)
  - 자연키 or 인조키
    - 자연키 : 중복된 값들을 제외하고 중복되지 않는 데이터를 지닌 키. 언젠가 변하는 속성
    - 인조키 : 인위적으로 생성 (예: 유저 아이디). 변하지 않는 속성 :point_right: 보통 기본키로 설정
      - 오라클 : sequence
      - MySQL : auto increment

![PK,FK,SK](./images/fk.jpeg)

- 외래키(Foreign Key,FK)

  - 다른 테이블의 키본키를 그대로 참조하는 값
  - 개체와의 관계를 식별
  - 중복 가능

- 후보키(candidate key)

  - 기본키가 될 수 있는 후보들
  - 유일성, 최소성

- 대체키(alternate key)

  - 후보키가 두 개 이상일 경우 하나를 기본키로 지정하고 남은 후보키들

- 슈퍼키(super key)
  - 각 레코드를 유일하게 식별할 수 있는 유일성을 갖춘 키

# 4.2 ERD와 정규화 과정

- ERD(Entity Relationship Diagram)
  - DB 구축 시 가장 기초적인 뼈대
  - 릴레이션 간의 관계 정의

## 4.2.1 ERD의 중요성

- ERD
  - 시스템의 요구 사항 기반으로 작성
  - DB 구축 이후에도 디버깅이나 비즈니스 프로세스 재설계가 필요할 경우 설계도 역할
  - 장점 : 관계형 구조로 표현할 수 있는 데이터를 구성하는 데 유용
  - 단점 : 비정형 데이터를 충분히 표현할 수 없다.
    - 비정형 데이터 : 비구조화 데이터
    - 미리 정의된 데이터 모델이 없거나 미리 정의된 방식으로 정리되지 않은 정보

## 4.2.2 예제로 배우는 ERD

![ERD 예제](./image/../images/ERD_example.jpeg)

## 4.2.3 정규화 과정

([이미지 출처](https://qwefgh90.github.io/_downloads/정규화참고.pptx))

- 정규화 과정
  - 릴레이션 간의 잘못된 종속 관계로 DB 이상 현상이 일어난 것을 해결
    - DB 이상 현상 : 중복 이상, 삭제 이상, 삽입 이상
  - 저장 공간을 효율적으로 사용하기 위해 릴레이션을 여러 개로 분리하는 과정
  - 정규화 과정이 좋은 성능을 보장하지는 않음
  - 정규화 원칙
    - 같은 의미를 표현하는 릴레이션이지만 더 좋은 구조로 만들어야 함
    - 자료의 중복성 감소
    - 독립적인 관계는 별개의 릴레이션으로 표현
    - 각각의 릴레이션은 독립적인 표현이 가능해야 한다
  - 제1정규형(1NF)
    - ![1NF](./images/1NF.jpg)
    - 릴레이션의 모든 도메인이 더 이상 분해될 수 없는 원자값으로만 구성
    - 릴레이션의 속성 값 중에서 한 개의 기본키에 대해 두 개 이상의 값을 가지는 반복 집합이 있어선 안됨
  - 제2정규형(2NF)
    - ![2NF](./images/2NF.png)
    - 릴레이션이 제1정규형이며 부분 함수의 종속성을 제거한 형태
    - 부분 함수의 종속성 제거 : 기본키가 아닌 모든 속성이 기본키에 완전 함수 종속적
    - 릴레이션을 분해할 때 동등한 릴레이션으로 분해해야 함
    - 정보 손실이 발생하지 않는 무손실 분해로 분해
  - 제3정규형(3NF)
    - ![3NF](./images/3NF.png)
    - 제2정규형이고 기본키가 아닌 모든 속성이 이행적 함수 종속(transitive FD)을 만족하지 않는 상태
      - 이행적 함수 종속 : A:point_right:B와 B:point_right:C 관계에서 A:point_right:C가 성립하게 될때 C가 A에 이행적으로 함수 종속되었다고 함
    - 보이스/코드 정규형(BCNF)
      - ![BCNF](./images/BCNF.png)
      - 3NF이고, 결정자가 후보키가 아닌 함수 종속 관계를 제거하여 릴레이션의 함수 종속 관계에서 모든 결정자가 후보키인 상태
        - 결정자
          - 함수 종속 관계에서 특정 종속자(dependent)를 결정짓는 요소
          - X:point_right:Y 일때 X는 결정자, Y는 종속자
