# 네트워크
- 컴퓨터 등의 장치들이 통신 기술을 사용하여 구축하는 연결망
- 노드(node)와 링크(link)가 서로 연결되어 있거나 연결되어 있지 않은 집합체
  - 노드: 서버, 라우터, 스위치 등 네트워크 장치
  - 링크: 유선 또는 무선

<br>

# 2.1 네트워크의 기초
## 2.1.1 처리량과 지연시간
좋은 네트워크 = 처리량↑, 지연시간↓, 장애빈도↓, 보안성↑

### 처리량(throughput)
> 링크를 통해 전달되는 단위 시간당 데이터량
- 단위: bps(bits per second)
- 영향 받는 요소
  - 트래픽
  - 네트워크 장치 간의 대역폭
    대역폭: 주어진 시간 동안 네트워크 연결을 통해 흐를 수 있는 최대 비트 수
  - 네트워크 중간에 발생하는 에러
  - 장치의 하드웨어 스펙

### 지연 시간(latency)
> 요청이 처리되는 시간. 어떤 메시지가 두 장치 사이를 왕복하는 데 걸린 시간
- 영향 받는 요소
  - 매체 타입(유선, 무선)
  - 패킷 크기
  - 라우터의 패킷 처리 시간

<br>

## 2.1.2 네트워크 토폴로지와 병목 현상
### 네트워크 토폴로지(network topology)
> 노드와 링크의 배치 방식, 연결 형태. 네트워크 설계시 고려

### 트리(tree) 토폴로지
- 계층형 토폴로지
- 노드의 추가, 삭제가 쉬움
- 특정 노트에 트래픽이 집중되면 하위 노드에 영향을 끼칠 수도 있음

### 버스(bus) 토폴로지
- 중앙 통신 회선 하나에 여러 개의 노드가 연결되어 공유함
- 근거리 통신망(LAN)에서 사용
- 장점
  - 설치 비용이 적음
  - 신뢰성 우수
  - 중앙 통신 회선에 노드를 추가, 삭제하기 쉽다
- 단점
  - 스푸핑이 가능하다
  #### 스푸핑
  > LAN 상에서 송신부의 패킷이 특정 노드에 오도록 처리하는것
  - 패킷을 송신과 관련 없는 다른 호스트에 가지 않도록 하는 스위칭 기능을 마비시키거나 속인다.

### 스타(star) 토폴로지
- 성형 토폴로지
- 중앙에 있는 노드에 모두 연결된 네트워크 구성
- 장점
  - 노드를 추가하기 쉬움
  - 에러 탐지 쉬움
  - 패킷의 충돌 발생 가능성 적음
  - 노드에 장애가 발생했을 때 쉽게 발견 가능
  - 장애 노드가 중앙 노드가 아닐 경우, 다른 노드에 끼치는 영향이 적다
- 단점
  - 중앙 노드에 장애가 발생하면 전체 네트워크를 사용할 수 없다
  - 설치 비용이 고가

### 링형(ring) 토폴로지
- 각각의 노드가 양 옆의 두 노드와 연결하여, 고리처럼 하나의 연속된 길을 통해 통신을 하는 망 구성 방식
- 장점
  - 노드 수가 증가되어도 네트워크상 손실이 거의 없다
  - 충돌 가능성 적다
  - 노드 고장시 빠르게 발견 가능
- 단점
  - 네트워크 구성 변경이 어렵다
  - 회선에 장애가 발생하면 전체 네트워크에 영향이 크다

### 메시(mesh) 토폴로지
- 망형 토폴로지
- 그물망처럼 연결되어있는 구조
- 장점
  - 여러 개의 경로가 존재
    - 한 단말에 장애가 발생해도 네트워크를 계속 사용할 수 있다.
    - 트래픽도 분산처리 가능
- 단점
  - 노드 추가 어려움
  - 구축, 운영 비용이 고가

### 병목(bottleneck) 현상
> 전체 시스템의 성능이나 용량이 하나의 구성 요소로 인해 제한받는 현상
- 트래픽이 많을 때 잘 관리하지 못하면 병목현상이 생겨 사용자가 웹 사이트로 들어가지 못한다.
- **네트워크 토폴로지의 형태와 경로를 알아야 병목 현상을 해결할 수 있다.**
- 원인
  - 네트워크 대역폭
  - 네트워크 토폴로지
  - 서버 CPU, 메모리 사용량
  - 비효율적인 네트워크 구성

<br>

## 2.1.3 네트워크 분류
- 규모를 기반으로 분류

### LAN(Local Area Network)
- 근거리 통신망
- 같은 건물이나 캠퍼스 같은 좁은 공간에서 운영됨
- 전송속도가 빠르고 혼잡하지 않다.

### MAN(Metropolitan Area Network)
- 대도시 지역 네트워크
- 도시 같은 넓은 지역
- 전송속도는 평균, LAN보다 혼잡하다

### WAN(Wide Area Network)
- 광역 네트워크
- 국가 또는 대륙
- 전송속도가 느리고 MAN보다 혼잡하다.

<br>

## 2.1.4 네트워크 성능 분석 명령어
서비스의 문제가 네트워크 병목현상 때문인지 검증할 때 사용되는 명령어들

### ping
> ping [IP 주소 or 도메인 주소]
- 네트워크 상태를 확인하려는 대상 노드를 향해 일정 크기의 패킷을 전송하는 명령어
- 해당 노드까지의 네트워크 연결 상태, 패킷 수신 상태와 도달 시간을 알 수 있음
- TCP/IP 프로토콜 중 ICMP 프로토콜을 통해 작동

### netstat
> netstat
- 서버들의 네트워크 상태 표시
- 네트워크 접속, 라우팅 테이블, 네트워크 프로토콜 등 리스트를 보여줌
- 주로 서비스의 포트가 열려있는지 확인할 때 사용

### nslookup
> nslookup
- 특정 도메인에 매핑된 IP(DNS)를 확인할 때 사용

### traceart
> traceart [IP 주소 or 도메인 주소]
- 목적지 노드까지의 네트워크 경로를 확인할 때 사용
- 어떤 구간에서 응답 시간이 느려지는지 등을 확인 가능

<br>

## 2.1.5 네트워크 프로토콜 표준화
### 네트워크 프로토콜
> 다른 장치들끼리 데이터를 주고받기 위해 설정된 공통된 인터페이스
- IEEE 또는 IETF라는 표준화 단체가 정한다.
- 예시
  - IEEE802.3: 유선 LAN 프로토콜
  - HTTP: 웹 접속할 때 사용

<br>

# 2.2 TCP/IP 4계층 모델
### 인터넷 프로토콜 스위트(Internet protocol suite)
-  인터넷에서 컴퓨터들이 서로 정보를 주고받는 데 쓰이는 프로토콜의 집합
- TCP/IP 4계층 모델 or OSI 7계층 모델로 설명


# 2.2.1 계층 구조
### TCP/IP 4계층
- 특정 계층이 변경되어도 다른 계층은 영향을 받지 않는다.

<br>

## 애플리케이션(application) 계층
- OSI 7계층에서는 애플리케이션 계층, 프레젠테이션 계층, 세션 계층으로 나뉨
- **웹 서비스, 이메일 등 서비스를 실질적으로 사람들에게 제공하는 층**
- FTP, HTTP, SSH, SMTP, DNS 등 응용프로그램이 사용되는 프로토콜 계층
  - FTP: 장치와 장치 간의 파일을 전송하는 데 사용되는 표준 통신 프로토콜
  - SSH: 보안되지 않은 네트워크 서비스를 안전하게 운영하게 위한 암호화 네트워크 프로토콜
  - HTTP: World Wide Web을 위한 데이터 통신의 기초이자 웹 사이트를 이용하는 데 쓰는 프로토콜
  - SMTP: 전자 메일 전송을 위한 인터넷 표준 통신 프로토콜
  - DNS: 도메인 이름과 IP주소를 매핑해주는 서버

<br>

## 전송(transport) 계층
- 송신자와 수신자를 연결하는 통신 서비스 제공
- 연결 지향 데이터 스트림 지원, 신뢰성, 흐름 제어 제공
- 애플리케이션과 인터넷 계층 사이 데이터가 전달될 때 중계 역할

<br>

### TCP - 가상회선 패킷 교환 방식
- 연결지향 프로토콜을 사용한 연결로 신뢰성 구축
- 패킷 수신여부를 확인
- 각 패킷에는 가상회선 식별자가 포함됨
- 모든 패킷을 전송하면 가상회선이 해제됨
- 패킷들은 같은 경로로, 전송된 순서대로 도착함

### UDP - 데이터그램 패킷 교환 방식
- 패킷 수신여부를 확인하지 않음
- 패킷은 독립적으로, 최선의 경로를 선택하여 이동
- 하나의 메시지에서 분할된 패킷이라도 서로 다른 경로로 전달될 수 있다.
- 전송된 순서와 도착 순서가 다를 수 있다.

<br>

### 3-way handshake: TCP 연결 성립 과정
이 과정 이후 **신뢰성이 구축**되고, 데이터 전송을 시작한다.
1. `클라이언트` SYN 단계
    - 서버에 자신의 ISN을 담은 SYN을 보냄
      - ISN: Initial Sequence Number. 초기 네트워크 연결을 할 때 패킷에 할당되는 임의의 시퀀스 번호
2. `서버` SYN + ACK 단계
    - 서버가 SYN 수신
    - 클라이언트에 ACK를 보냄
      - 서버의 ISN
      - 승인번호: 클라이언트에게서 받은 ISN + 1
3. `클라이언트` ACK 단계
    - 클라이언트가 서버로 ACK를 보냄
      - 승인번호: 서버에게서 받은 ISN + 1

### 4-way handshake: TCP 연결 해제 과정
1. `클라이언트`
    - 서버로 FIN으로 설정된 세그먼트를 보냄
    - 클라이언트는 FIN_WAIT_1 상태가 되어 서버 응답을 기다림
2. `.`
    - `서버`
        - 클라이언트로 ACK라는 승인 세그먼트를 보냄
        - CLOSE_WAIT 상태가 됨
    - `클라이언트`
      - ACK를 받으면 FIN_WAIT_2 상태가 됨
3. `서버`
    - 일정 시간 이후에 클라이언트에 FIN 세그먼트를 보냄
4. `클라이언트`
    - TIME_WAIT 상태가 됨
    - 다시 서버로 ACK를 보냄 -> 서버가 CLOSED 됨
    - 어느 정도 시간을 대기한 후, 양쪽 간의 모든 자원의 연결이 해제된다.
      - Q. TIME_WAIT이 필요한 이유?
        - TIME_WAIT: 소켓이 바로 소멸되지 않고 일정 시간 유지되는 상태
        1. 지연된 패킷이 뒤늦게 도착하고 이를 처리하지 못하면 데이터 무결성 문제 발생
            - 데이터 무결성(Data Integrity) : 데이터의 정확성과 일관성을 유지하고 보증하는 것
        2. 두 장치의 연결이 닫혔는지 확인하기 위해서

<br>

## 인터넷(Internet) 계층
- 장치로부터 받은 네트워크 패킷을 지정된 IP 주소로 전송하기 위해 사용되는 계층
- IR, ARP, ICMP 등
- 비연결형적 특징: 상대방이 제대로 받았는지는 보장하지 않음

<br>

## 링크 계층
- 네트워크 접근 계층
- 전선, 광섬유, 무선 등으로 실질적으로 데이터를 전달하는 계층
1. 물리 계층
  - 무선, 유선 LAN을 통해 0과 1로 이루어진 데이터를 보내는 계층
2. 데이터 링크 계층
  - 이더넷 프레임을 통해 에러 확인, 흐름 제어, 접근 제어를 담당

<br>

### 유선 LAN(IEEE802.3)
- 유선 LAN을 이루는 이더넷은 IEEE802.3 프로토콜을 따른다.
  #### 전이중화(full duplex) 통신
  - 양쪽 장치가 동시에 송수신 가능한 방식
  - 송신로와 수신로로 나누어짐
  - 현대의 고속 이더넷은 이 방식을 기반으로 함
  #### CSMA/CD: 반이중화 통신
  - 예전에 썼던 방식
  - 데이터를 보낸 후, 충돌이 발생하면 일정 시간 후 재전송하는 방식
  - 경호가 하나밖에 없기 때문에 충돌에 대비해야 했음

### 유선 LAN을 이루는 케이블
  - 트위스트 페어 케이블(TP 케이블)과 광섬유 케이블이 대표적
  #### 트위스트 페어 케이블(twisted pair cable)
  - 하나의 케이블 안에 8개의 구리선이 두 개씩 묶여있음
  #### 광섬유 케이블
  - 광섬유로 만든 케이블
  - 레이저를 이용하기 때문에 장거리, 고속 통신 가능
  - 코어(Core): 빛의 굴절률이 높은 안쪽 부분
  - 클래딩(Cladding): 빛의 굴절률이 낮은 바깥쪽 부분

<br>

### 무선 LAN(IEEE802.11)
- 수신과 송신에 같은 채널을 사용 -> 반이중화 통신 사용
  #### 반이중화 통신
  - 양쪽 장치가 동시에 통신할 수 없다. 한 번에 한 방향으로만 가능
  - 동시에 전송할 때를 대비하여 충돌 방지 시스템 필요
  #### CSMA/CA
  - 반이중화 통신 중 하나
  - 데이터를 보내기 전에 캐리어 감지 등으로 사전에 충돌을 방지하는 방식

### 무선 LAN을 이루는 주파수
- 무선 LAN(WLAN, Wireless Local Area Network)
  - 공기에 주파수를 쏴서 무선 통신망 구축
    - 주파수 대역
      - 2.4 GHz: 장애물에 강하지만 전파간섭이 잦음
      - 5 GHz: 채널 수 많고 상대적으로 깨끗한 전파 환경
  #### 와이파이(wifi)
  - 전자기기들이 무선 LAN 신호에 연결할 수 있게 하는 기술
  - 사용하려면 무선 접속 장치(AP, Access Point, 공유기) 필요
    - 유선 LAN에 흐르는 신호를 무선 LAN 신호로 바꿔준다.
  - 동일하게 무선 LAN을 이용한 다른 기술들: 지그비, 블루투스
  #### BSS(Basic Service Set)
  - 단순히 공유기를 통해 네트워크에 접속하는 것이 아니라, 동일 BSS 내에 있는 AP와 장치들이 서로 통신 가능한 구조
  - 근거리 무선 통신 제공
  - 하나의 AP만을 기반으로 구축되어있어, 사용자가 자유롭게 이동할 수는 없다
  #### ESS(Extended Service Set)
  - BSS가 하나 이상 연결된 그룹
  - 장거리 무선 통신 제공
  - 사용자는 장소를 이동하며 네트워크에 계속 연결할 수 있다

<br>

### 이더넷 프레임
- 데이터 링크 계층은 이더넷 프레임을 통해 전달받은 데이터의 에러를 검출하고 캡슐화함
- 구조
  1. Premble: 이더넷 프레임의 시작을 알린다.
  2. SFD(Start Frame Delimiter): 다음 바이트부터 MAC 주소 필드임을 알린다.
  3. DMAC: 수신 MAC 주소
  4. SMAC: 송신 MAC 주소
  5. EtherType: 데이터 fldzm 계층 위의 계층인 IP 프로토콜을 정의함. 예를 들어 IPv4 or IPv6
  6. Payload: 전달받은 데이터
  7. CRC: 에러 확인 비트
  #### MAC 주소
  - 컴퓨터나 노트북 등의 장치에 든, 네트워크에 연결하기 위한 장치(LAN 카드)의 식별번호.
  - 6바이트(48비트)로 구성된다

<br>

## 계층 간 데이터 송수신 과정
- 클라이언트가 서버에 데이터를 요청할 때의 과정
  1. (클라이언트)
    - 애플리케이션 계층에서 링크 계층까지 캡슐화 과정을 거침
    - 링크 계층에서 서버와 통신
  2. (서버)
    - 링크계층에서 애플리케이션까지 비캡슐화 과정을 거침
  #### 캡슐화 과정
  - 상위 계층에서 하위 계층으로 가며, 윗 계층의 `헤더+데이터`를 `데이터`로 만들고 해당 계층의 새 헤더를 삽입하는 과정
  #### 비캡슐화 과정
  - 하위 계층에서 상위 계층으로 가며, 각 계층의 헤더 부분을 제거하는 과정

<br>

## 2.2.2 PDU(Protocol Data Unit)
> 네트워크의 계층 사이로 데이터가 전달될 때, 한 덩어리의 단위
- 헤더(제어 관련 정보), 페이로드(데이터)로 구성됨
- 계층마다 명칭이 다르다
  - 애플리케이션 계층: 메시지
  - 전송 계층: 세그먼트(TCP), 데이터그램(UDP)
  - 인터넷 계층: 패킷
  - 링크 계층: 프레임(데이터 링크 계층), 비트(물리 계층)

<br>

# 2.3 네트워크 기기
## 2.3.1 네트워크 기기의 처리 범위
- 계층 별로 나눠진다.
  - 애플리케이션 계층: L7 스위치
  - 인터넷 계층: 라우터, L3 스위치
  - 데이터 링크 계층: L2 스위치
  - 물리 계층: NIC, 리피터, AP
- 상위 계층을 처리하는 기기는 하위 계층을 처리할 수 있다. 반대는 불가

<br>

## 2.3.2 애플리케이션 계층을 처리하는 기기
### L7 스위치 = 로드밸런서
> 여러 장비를 연결하고 데이터 통신을 중재하며, 목적지가 연결된 포트로만 전기 신호를 보내 데이터를 전송하는 통신 네트워크 장비
- 서버의 부하(트래픽)를 분산하는 기기
  - 클라이언트의 요청들을 뒤쪽의 여러 서버로 나눈다
  - 시스템이 처리 가능한 트래픽을 증가시킨다
  - 정기적으로 헬스 체크를 하여, 장애가 발생한 서버가 있는지 감시한다 -> 장애 서버를 트래픽 분산 대상에서 제외
- 바이러스, 불필요한 외부 데이터 등을 걸러내는 필터링 기능
- 응용 프로그램 수준의 트래픽 모니터링 가능

### L4 스위치와 L7 스위치의 차이
- L7 스위치: IP, 포트 외에도 URL, HTTP 헤더, 쿠키 등을 기반으로 트래픽을 분산시킴
- L4 스위치: 인터넷 계층을 처리하는 기기. IP, 포트를 기반으로 트래픽을 분산시킴. 스트리밍 서비스에서는 사용 불가능
- 클라우드 서비스(AWS 등)에서 로드밸런싱할 때 컴포넌트 종류
  - L7: ALB(Application Load Balancer) 컴포넌트
  - L4: NLB(Network Load Balancer) 컴포넌트

### L4 스위치와 L7 스위치에서의 헬스 체크
- 비정상적인 서버를 판별함
- 전송 주기와 재전송 횟수 등을 설정하고, 반복적으로 서버에 요청을 보내는 것
  - 요청 횟수는 서버에 부하가 되지 않을 만큼만
- TCP, HTTP 등 다양한 방법으로 요청
- 요청이 정상적으로 이루어졌다면 정상적인 서버로 판별

### 로드밸런서를 이용한 서버 이중화
- 2대 이상의 서버를 기반으로 가상 IP를 제공하고, 이를 기반으로 안정적인 서비스를 제공함
- 서버 1대가 에러로 종료되면 다른 서버를 사용하면 됨

<br>

## 2.3.3 인터넷 계층을 처리하는 기기
- 라우터, L3스위치

### 라우터(router)
- 다른 네트워크에 있는 장치끼리 서로 데이터를 주고받을 때, 패킷 소모를 최소화하고 **경로를 최적화하여 최소 경로로 패킷을 포워딩(라우팅)**하는 장비
- 여러 개의 네트워크를 연결, 분할, 구분시켜주는 역할

### L3 스위치
- L2 스위치의 기능 + 라우팅 기능
- 하드웨어 기반 라우팅을 담당하는 장치

  |구분|L2 스위치|L3 스위치|
  |----|---------|---------|
  |참조 테이블|MAC 주소 테이블|라우팅 테이블|
  |참조 PDU|이더넷 프레임|IP 패킷|
  |참조 주소|MAC 주소|IP 주소|

<br>

## 2.3.4 데이터 링크 계층을 처리하는 기기
- L2 스위치, 브리지

### L2 스위치
- 연결된 장치로부터 패킷이 왔을 때 패킷 전송을 담당
- 장치들의 MAC 주소를 MAC 주소 테이블로 관리함
- IP 주소를 이해하지 못하기 때문에, IP 주소를 기반으로 라우팅 할 수는 없다. 단순히 패킷의 MAC 주소를 읽어 스위칭함

### 브리지(bridge)
- 두 개의 근거리 통신망(LAN)을 상호 접속할 수 있도록 하는 통신망 연결 장치
  - 통신망 범위를 확장, 서로 다른 LAN 들을 하나의 통신망으로 구축함
- 포트와 포트 사이의 다리 역할
- 장치에서 받아온 MAC 주소를 MAC 주소 테이블로 관리함

<br>

## 2.3.5 물리 계층을 처리하는 기기
- NIC, 리피터, AP

### NIC(네트워크 인터페이스 카드, Network Interface Card)
- LAN 카드라고 함
- 네트워크와 빠른 속도로 데이터를 송수신할 수 있도록 컴퓨터 내에 설치하는 확장 카드
- 2대 이상의 컴퓨터 네트워크를 구성하는 데 사용
- 각 NIC에는 고유의 식별번호인 MAC 주소가 있음

### 리피터(repeater)
- 들어오는 약해진 신호 정도를 증폭하여 다른 쪽으로 전달하는 장치
- 패킷이 더 멀리 갈 수 있게 하지만, 광케이블이 보급되면서 지금은 잘 쓰이지 않는다.

### AP(Access Point)
- 패킷을 복사하는 기기
- AP에 유선 랜을 연결한 후, 다른 장치에서 무선 LAN 기술(와이파이 등)을 사용하여 무선 네트워크 연결을 할 수 있다.

<br>

# 2.4 IP 주소
- 인터넷 계층에 IP 주소를 쓴다.

## 2.4.1 ARP(Address Resolution Protocol)
- IP 주소(가상 주소, 논리적 주소)로부터 MAC 주소(실제 주소, 물리적 주소)를 구하는 프로토콜
- 반대 역할의 프로토콜은 **RARP**
- 컴퓨터 간의 통신은 ARP를 통해 IP 주소로부터 MAC 주소를 찾아 MAC 주소를 기반으로 통신하는 것.
- ARP로 주소를 찾는 과정
  1. 장치 A가 네트워크에 연결된 모든 호스트에게 찾고 싶은 IP 주소의 MAC가 무엇인지 브로드캐스트를 보냄
  2. 해당 주소에 맞는 장치 B가 MAC 주소를 반환하는 ARP reply 유니캐스트를 보냄
  #### 브로드캐스트
  > 송신 호스트가 전동한 데이터가 네트워크에 연결된 모든 호스트에 전송되는 방식
  #### 유니캐스트
  > 고유 주소로 식별된 하나의 네트워크 목적지에 1:1로 데이터를 전송하는 방식

<br>

## 2.4.2 홉바이홉(hop by hop) 통신
> IP 주소를 통해 통신하는 과정
- 통신망에서 각 패킷이 여러 개의 라우터를 건너가는 모습을 표현한 것
- 각 라우터에 있는 라우팅 테이블의 IP를 통해, 시작 주소에서 최종 목적지까지 도달하는 통신
  #### 라우팅
  > IP 주소를 찾아가는 과정

### 라우팅 테이블(routing table)
> 라우터에 들어가 있는 목적지 정보들과 그 목적지로 가기 위한 방법이 들어있는 리스트
- 송신지에서 수신지까지 도달하기 위해 사용됨

### 게이트웨이(gateway)
> 서로 다른 통신망, 프로토콜을 사용하는 네트워크 간의 통신을 가능하게 하는 관문 역할을 하는 컴퓨터나 소프트웨어를 두루 일컫는 용어
- 사용자는 인터넷에 접속하기 위해 수많은 톨게이트인 게이트웨이를 거쳐야 함
- 게이트웨이는 서로 다른 네트워크상의 통신 프로토콜을 변환해주기도 함

<br>

## 2.4.3 IP 주소 체계
1. IPv4
    - 32비트를 8비트 단위로 점을 찍어 표기
    - IP주소: 123.45.67.89 같은 방식
    - 현재 가장 많이 쓰이는 주소 체계
2. IPv6
    - 64비트를 16비트 단위로 점을 찍어 표기
    - IP 주소: 2001:db8::ff00:42:8329 같은 방식

### 클래스 기반 할당 방식(CIDR)
- A, B, C, D, E 다섯 개의 클래스로 구분
- 앞 부분을 네트워크 주소, 뒷부분을 호스트 주소(컴퓨터에 부여하는 주소)로 놓고 사용
- 클래스 A, B, C는 일대일 통신
- 클래스 D는 멀티캐스트 통신
- 클래스 E는 예비용 주소
- 클래스 당 IP 주소 범위는 맨 왼쪽에 있는 `구분비트`로 나눠진다
- 네크워크의 첫 번째 주소는 네트워크 구별 주소로 사용
- 네트워크의 가장 마지막 주소는 브로캐스트용 주소로 사용 (네트워크에 속해있는 모든 컴퓨터에 데이터를 보내는 역할)
- 둘 사이의 주소를 호스트 주소(컴퓨터에 부여할 수 있는 주소)로 사용할 수 있다

<br>

### DHCP(Dynamic Host Configuration Protocol)
> IP 주소 및 기타 통신 매개변수를 자동으로 할당하기 위한 네트워크 관리 프로토콜
- 네트워크 장치의 IP 주소를 수동으로 설정할 필요 없이, 인터넷에 접속할 때 마다 자동으로 IP 주소를 할당할 수 있다.
- 많은 라우터와 게이트웨이 장비에 DHCP 기능이 있다.

<br>

### NAT(Network Address Translation)
> 패킷이 라우팅 장치를 통해 전송되는 동안, 패킷의 IP 주소 정보를 수정하여 IP 주소를 다른 주소로 매핑하는 방법
- NAT는 공인 IP와 사설 IP로 나눠서 많은 주소를 처리한다.
  - -> IPv4 주소 체계로는 많은 주소들을 모두 감당하지 못하는 단점을 해결
- 하나의 공인 IP를 가지고 여러 개의 IP(사설 IP)를 가지는 것처럼 인터넷을 쓸 수 있다.
  - NAT가 사설, 공인 IP 사이를 변환한다.
  - 하나의 공인 IP로 외부 인터넷에 요청할 수 있다.

  #### 공유기와 NAT
  - NAT는 여러 대의 호스트가 하나의 공인 IP 주소를 이용하여 인터넷에 접속하도록 함
  - ex) 인터넷 공유기에는 NAT 기능이 탑재되어 있다.
    - 인터넷 회선 하나를 개통하고 인터넷 공유기를 달면 여러 PC를 연결하여 쓸 수 있다.

  #### NAT를 이용한 보안
  - 내부 네트워크에 대한 어느 정도의 보안을 유지할 수 있다
    - 내부 네트워크에서 사용하는 IP 주소와 외부에 드러나는 IP 주소를 다르게 할 수 있기 때문에

  #### NAT의 단점
  - 접속 속도가 느려질 수 있음
    - 여러 명이 동시에 인터넷에 접속할 수 있기 때문에, 실제로 접속하는 호스트의 숫자에 따라 느려진다

 <br>

 ## 2.4.4 IP 주소를 이용한 위치 정보
 - IP 주소를 기반으로 동 또는 구까지 위치 추적 가능

 <br>

# 2.5 HTTP
- 애플리케이션 계층으로서 웹 서비스 통신에 사용됨

## 2.5.1 HTTP/1.0
- 한 연결당 하나의 요청을 처리하도록 설계됨 -> RTT 증가를 초래

### 단점: RTT 증가
- RTT
  - 패킷 왕복 시간. 패킷이 목적지에 도달하고 나서 다시 출발지로 돌아오기까지 걸리는 시간.
- 서버로부터 파일을 가져올 때 마다 TCP 3-way-handshake를 열어야 하기 때문에 RTT가 증가한다
- 서버에 부담이 많이 가고 사용자 응답 시간이 길어진다.

### RTT 증가를 해결하는 방법
### 1. 이미지 스플리팅
- 많은 이미지가 합쳐진 하나의 이미지를 다운로드 받고, background-image의 position을 이용하여 이미지를 표시하는 방법
- 많은 이미지를 다운로드 받으면 과부하가 걸리기 때문에 사용하는 방법

### 2. 코드 압축
- 개행 문자, 띄어쓰기를 없애는 등 코드를 압축해서 코드 용량을 최소화하는 방법

### 3. 이미지 Base64 인코딩
- 이미지 파일을 64진법으로 이루어진 Base64 문자열로 인코딩하는 방법
- 장점: 서버와의 연결을 열고 이미지에 대해 HTTP 요청을 할 필요가 없다.
- 단점: 37% 정도 크기가 더 커진다
  #### 인코딩
  > 정보의 형태나 형식을 다른 것으로 변환하는 처리 방식. 표준화, 보안, 처리 속도 향상, 저장 공간 절약 등을 위해 함

<br>

## 2.5.2 HTTP/1.1
- HTTP/1.0에서 발전한 것
  - 매번 TCP 연결을 하지 않고, 한 번 TCP 초기화를 한 이후에 keep-alive라는 옵션으로 여러 개의 파일을 송수신할 수 있게 되었다.
  - 단점: 다수의 리소스(이미지, css 파일, script 파일)를 처리하려면, 요청할 리소스 개수에 비례해서 대기 시간이 길어진다.

### HOL Blocking(Head Of Line Blocking)
> 네트워크에서 같은 큐에 있는 패킷이 첫 번째 패킷에 의해 지연될 때 발생하는 성능 저하 현상
- ex) 여러 리소스를 다운로드 받을 때, 뒷 순서의 리소스 다운로드가 지연될 수 있다

### 무거운 헤더 구조
- 헤더에 쿠키 등 많은 메타데이터가 들어있고, 압축이 되지 않아 무거웠다.

<br>

## 2.5.3 HTTP/2
- HTTP/1.1에서 발전한 것
  - 지연 시간을 줄이고 응답시간이 더 빠름
  - 멀티플렉싱, 헤더 압축, 서버 푸시, 요청의 우선순위 처리를 지원하는 프로토콜

### 멀티플렉싱
> 하나의 연결 내에서 여러 개의 스트림을 사용하여 송수신한다는 것
- 단일 연결 내에서 여러 요청과 응답을 할 수 있다. => **HTTP/1.x에서의 HOL Blocking 해결**
- 특정 스트림의 패킷이 손실되어도, 나머지 스트림은 잘 동작한다.
- 애플리케이션에서 받아온 메시지를 독립된 프레임으로(스트림 내의 쪼개진 데이터) 서로 송수신함 -> 이후 다시 조립함
  #### 스트림(stream)
  > 시간이 지남에 따라 사용할 수 있게 되는 일련의 데이터 요소를 가리키는 데이터 흐름

### 헤더 압축
- 헤더 압축을 통해 **HTTP/1.x에서의 무거운 헤더 구조 해결**
  - 허프만 코딩 압축 알고리즘을 사용하는 HPACK 압축 형식을 가짐
    #### 허프만 코딩(huffman coding)
    - 전체 데이터의 표현에 필요한 비트양을 줄임
      - 문자열을 문자 단위로 쪼갠다
      - 빈도가 높은 정보는 적은 비트수로 표현하고, 빈도가 낮은 정보는 많은 비트수로 표현

### 서버 푸시
- HTTP/1.1과 다르게 **클라이언트의 요청 없이 서버가 바로 리소스를 푸시**할 수 있다.
- html을 읽으면서 그 안에 들어있는 css나 js 파일을 서버에서 푸시하여 클라이언트에게 먼저 줄 수 있다.

<br>

## 2.5.4 HTTPS
> 애플리케이션 계층과 전송 계층 사이에 SSL/TLS 계층(신뢰 계층)을 넣은 신뢰할 수 있는 HTTP 요청
- 이를 통해 통신을 암호화
- HTTP/2는 HTTPS 위에서 동작

### SSL/TLS
> 전송 계층에서 보안을 제공하는 프로토콜
- 서버 통신시 제 3자가 메시지를 도청, 변조하지 못하게 한다.
- 인터셉터 방지
  - 인터셉터: 공격자가 서버인 척하며 사용자 정보를 가로채는 것
- 보안 세션을 기반으로 데이터를 암호화한다
  - 보안 세션이 만들어질 때 인증 메커니즘, 키 교환 암호화 알고리즘, 해싱 알고리즘이 사용됨
  #### 보안 세션
  > 보안이 시작되고 끝나는 동안 유지되는 세션
  - SSL/TLS는 핸드셰이크로 보안 세션을 생성하고, 이를 기반으로 상태 정보 등을 공유함
  - 세션
    > 운영체제가 어떠한 사용자에게 자신의 자산 이용을 허락하는 일정한 기간. 사용자는 일정 시간 동안 응용 프로그램, 자원 등을 사용할 수 있다
    


